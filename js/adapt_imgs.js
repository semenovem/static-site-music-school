"use strict";function _objectSpread(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},t=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.forEach(function(e){_defineProperty(n,e,r[e])})}return n}function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var adaptImgs={app:null,_REQ_HIDE:/hide|none/,init:function(e){this.app=e,this._handleChangeScreen=this._handleChangeScreen.bind(this),this._findImgs(e.screen),this.app.addEventListener("changeScreen",this._handleChangeScreen)},_handleChangeScreen:function(e){this._findImgs(e.screen)},_findImgs:function(t){var n=this,e=document.querySelectorAll("[data-src]");Array.from(e).map(function(e){return _objectSpread({el:e},n._parseDataSrc(e.getAttribute("data-src")))}).map(function(e){return e.baseUrl||(e.baseUrl=n._minusSuffix(e.el.src)),e}).filter(function(e){return e.baseUrl}).map(this._calcScreenForImg,this).forEach(function(e){var n=e.el,r=e.screen[t];null!==r?n.src!==r&&(n.src=r):n.src&&(n.src="")})},_parseDataSrc:function(e){var t=this,a={baseUrl:"",screen:{}},c=this.app.screenHash;return e.split(/\s+/).filter(Boolean).forEach(function(e){if(t._isUrlImg(e))a.baseUrl=e;else{var n=e.slice(0,2);if(c[n]){var r=e.slice(2).match(/[\d\w]+$/i);a.screen[n]=r?r[0]:""}}}),a},_calcScreenForImg:function(e){var r,n=this,t=this.app.screenList,a=e.screen,c=e.baseUrl;return t.map(function(e){return a[e]&&n._REQ_HIDE.test(a[e])&&(a[e]=null),e}).map(function(e){switch(a[e]){case null:break;case void 0:void 0!==r&&(a[e]=r);break;default:a[e]=n._sumUrl(c,a[e]?a[e]:e)}return r=a[e],e}).reverse().forEach(function(e,n){switch(0===n&&(r=void 0),a[e]){case null:break;case void 0:void 0!==r&&(a[e]=r)}r=a[e]}),e},_isUrlImg:function(e){return/\.(jpg|png|svg)$/.test(e)},_sumUrl:function(e,n){return e.replace(/(.+)\.(jpg|png|svg)/,"$1--".concat(n,".$2"))},_minusSuffix:function(e){return e.replace(/(.*?)--.+?\.(jpg|png|svg)/,"$1.$2")}};app.domContentLoaded.then(adaptImgs.init.bind(adaptImgs,app));